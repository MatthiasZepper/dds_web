{% extends "bootstrap/base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block content %}
<title>2FA</title>

<body>
    <h1>Request one-time code</h1>
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class=flashes>
        {% for category, message in messages %}
        <div class="alert alert-{{category}}" role="alert">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}
    <p>Please authenticate yourself to trigger the sending of an authentication one-time code.
    </p>
    <p>
        Note that requesting a new authentication code will cancel the previously sent codes.
    </p>
    <p>
        The one-time codes are valid for a short time (1 hour) after the request was made.
    </p>
    <form method="POST" action="{{ url_for('auth_blueprint.request_2fa', next=next) }}">
        {{ form.csrf_token }}

        <!-- Username -->
        {{ form.username.label }}
        {{ form.username }}
        <ul>
            {% for error in form.username.errors %}
            <li style="color:red;">
                {{ error }}
            </li>
            {% endfor %}
        </ul>

        <!-- Password -->
        {{ form.password.label }}
        {{ form.password }}
        <ul>
            {% for error in form.password.errors %}
            <li style="color:red;">
                {{ error }}
            </li>
            {% endfor %}
        </ul>

        <!-- Submit button -->
        {{ form.submit }}

        <small class="text-muted ml-2">
            <a href="{{ url_for('auth_blueprint.request_reset_password')
                }}">
                Forgot Password?
            </a>
        </small>

    </form>

    {% endblock %}