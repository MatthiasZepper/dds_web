{% extends "bootstrap/base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block content %}
<title>Login</title>

<body>
    <h1>Login to DDS</h1>
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class=flashes>
        {% for category, message in messages %}
        <div class="alert alert-{{category}}" role="alert">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}
    <form method="POST" action="{{ url_for('auth_blueprint.login', next=next) }}">
        {{ form.csrf_token }}

        <!-- Username -->
        {{ form.username.label }}
        {{ form.username }}
        <ul>
            {% for error in form.username.errors %}
            <li style="color:red;">
                {{ error }}
            </li>
            {% endfor %}
        </ul>

        <!-- Password -->
        {{ form.password.label }}
        {{ form.password }}
        <ul>
            {% for error in form.password.errors %}
            <li style="color:red;">
                {{ error }}
            </li>
            {% endfor %}
        </ul>

        <!-- Token -->
        {{ form.hotp.label }}
        {{ form.hotp }}
        <ul>
            {% for error in form.hotp.errors %}
            <li style="color:red;">
                {{ error }}
            </li>
            {% endfor %}
            <small class="text-muted ml-2">
                <a href="{{ url_for('auth_blueprint.request_2fa')
                }}">
                    Request a new one-time code for authorization
                </a>
            </small>
        </ul>

        <!-- Submit button -->
        {{ form.submit }}

        <small class="text-muted ml-2">
            <a href="{{ url_for('auth_blueprint.request_reset_password')
                }}">
                Forgot Password?
            </a>
        </small>

    </form>

    {% endblock %}